"use client";
import { selectRole } from "@/app/Functions";
import { useStore } from "@/app/store/store";
import React, { useEffect, useState } from "react";

const page = () => {
  const { selectUserError } = useStore(); // ✅ استخدم getState

  const [role, setRole] = useState("");
  const [alert, setAlert] = useState(false);
  const alertFunction = () => {
    if (!role) {
      const errorSound = new Audio("/assets/error-sound.mp3");
      errorSound.play();
      setAlert(true);
      setTimeout(() => {
        setAlert(false);
      }, 1500);
    } else {
      setAlert(false);
      selectRole(role);
    }
  };
  return (
    <main className="Container relative  flex flex-col gap-8 sm:gap-14 items-center pt-2 pb-5 sm:pt-14">
      <h1 className="text-3xl font-bold">You Are A</h1>
      <ul className="flex   flex-wrap sm:flex-nowrap  justify-center  gap-20 items-center mb-24">
        <li
          className={`sm:w-1/3  duration-500 ${
            role === "student"
              ? "bg-[var(--main-color)] scale-110 font-bold text-[var(--main-color)]"
              : "bg-white"
          } p-6 sm:p-12 rounded-full cursor-pointer relative`}
          onClick={() => setRole("student")}
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="64"
            height="65"
            viewBox="0 0 88 88"
            fill="none"
          >
            <path
              d="M77.6531 20.0441L44.6531 9.04407C44.2292 8.90255 43.7708 8.90255 43.3469 9.04407L10.3469 20.0441C9.93649 20.1811 9.57958 20.4437 9.32666 20.7947C9.07373 21.1457 8.93759 21.5674 8.9375 22V49.5C8.9375 50.047 9.1548 50.5716 9.54159 50.9584C9.92839 51.3452 10.453 51.5625 11 51.5625C11.547 51.5625 12.0716 51.3452 12.4584 50.9584C12.8452 50.5716 13.0625 50.047 13.0625 49.5V24.86L26.3587 29.2944C24.682 31.7723 23.5458 34.5755 23.0241 37.5216C22.5023 40.4677 22.6067 43.4906 23.3305 46.3937C24.0542 49.2968 25.3811 52.0149 27.2247 54.3713C29.0684 56.7277 31.3875 58.6695 34.0312 60.0703C27.4141 62.315 21.6562 66.8044 17.5312 73.1328C17.2941 73.587 17.2345 74.1131 17.364 74.6088C17.4936 75.1045 17.8029 75.5342 18.2319 75.8143C18.6608 76.0944 19.1787 76.2049 19.6846 76.1241C20.1905 76.0434 20.6483 75.7772 20.9688 75.3775C26.2866 67.2341 34.6775 62.5625 44 62.5625C53.3225 62.5625 61.7134 67.2341 67.0312 75.3775C67.3498 75.7857 67.8101 76.0592 68.321 76.1436C68.8318 76.2281 69.3557 76.1173 69.7886 75.8333C70.2215 75.5493 70.5318 75.1128 70.6578 74.6106C70.7838 74.1085 70.7163 73.5772 70.4688 73.1225C66.3438 66.8044 60.5928 62.315 53.9688 60.06C56.6111 58.6576 58.9286 56.7147 60.7705 54.3576C62.6124 52.0006 63.9375 49.2822 64.6596 46.3792C65.3817 43.4763 65.4846 40.4538 64.9616 37.5085C64.4386 34.5632 63.3014 31.7609 61.6241 29.2841L77.6531 23.9559C78.0633 23.8187 78.4199 23.556 78.6726 23.205C78.9253 22.854 79.0612 22.4325 79.0612 22C79.0612 21.5675 78.9253 21.146 78.6726 20.795C78.4199 20.444 78.0633 20.1813 77.6531 20.0441ZM61.1875 41.25C61.1887 43.9888 60.5354 46.6882 59.2821 49.1233C58.0287 51.5584 56.2115 53.6588 53.982 55.2494C51.7525 56.84 49.1751 57.8747 46.4647 58.2675C43.7542 58.6602 40.9891 58.3995 38.3998 57.5072C35.8105 56.6148 33.472 55.1166 31.579 53.1374C29.686 51.1581 28.2934 48.7552 27.5172 46.1287C26.741 43.5022 26.6037 40.7283 27.1167 38.038C27.6298 35.3477 28.7783 32.819 30.4666 30.6625L43.3469 34.9559C43.7708 35.0975 44.2292 35.0975 44.6531 34.9559L57.5334 30.6625C59.9047 33.6818 61.1917 37.4109 61.1875 41.25ZM44 30.8275L17.5312 22L44 13.1725L70.4688 22L44 30.8275Z"
              fill={`${role === "student" ? "#fff" : "var(--main-color)"}`}
            />
          </svg>
          <p className={`absolute -bottom-14 text-center  text-xl`}>Student</p>
        </li>
        <li
          className={`sm:w-1/3  duration-500 relative ${
            role === "company"
              ? "bg-[var(--main-color)] scale-110 font-bold text-[var(--main-color)]"
              : "bg-white"
          } p-6 sm:p-12 rounded-full cursor-pointer`}
          onClick={() => setRole("company")}
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="64"
            height="65"
            viewBox="0 0 64 65"
            fill="none"
          >
            <path
              d="M10.2401 3.06V8.18H5.12012V61.94H58.8801V18.42H38.4001V8.18H33.2801V3.06H10.2401ZM12.8001 5.62H30.7201V10.74H35.8401V59.38H24.3201V50.42H19.2001V59.38H7.68012V10.74H12.8001V5.62ZM12.8001 13.3V15.86H15.3601V13.3H12.8001ZM17.9201 13.3V15.86H20.4801V13.3H17.9201ZM23.0401 13.3V15.86H25.6001V13.3H23.0401ZM28.1601 13.3V15.86H30.7201V13.3H28.1601ZM12.8001 19.7V24.82H15.3601V19.7H12.8001ZM17.9201 19.7V24.82H20.4801V19.7H17.9201ZM23.0401 19.7V24.82H25.6001V19.7H23.0401ZM28.1601 19.7V24.82H30.7201V19.7H28.1601ZM38.4001 20.98H56.3201V59.38H38.4001V20.98ZM40.9601 23.54V26.1H43.5201V23.54H40.9601ZM46.0801 23.54V26.1H48.6401V23.54H46.0801ZM51.2001 23.54V26.1H53.7601V23.54H51.2001ZM12.8001 27.38V32.5H15.3601V27.38H12.8001ZM17.9201 27.38V32.5H20.4801V27.38H17.9201ZM23.0401 27.38V32.5H25.6001V27.38H23.0401ZM28.1601 27.38V32.5H30.7201V27.38H28.1601ZM40.9601 28.66V31.22H43.5201V28.66H40.9601ZM46.0801 28.66V31.22H48.6401V28.66H46.0801ZM51.2001 28.66V31.22H53.7601V28.66H51.2001ZM40.9601 33.78V36.34H43.5201V33.78H40.9601ZM46.0801 33.78V36.34H48.6401V33.78H46.0801ZM51.2001 33.78V36.34H53.7601V33.78H51.2001ZM12.8001 35.06V40.18H15.3601V35.06H12.8001ZM17.9201 35.06V40.18H20.4801V35.06H17.9201ZM23.0401 35.06V40.18H25.6001V35.06H23.0401ZM28.1601 35.06V40.18H30.7201V35.06H28.1601ZM40.9601 38.9V41.46H43.5201V38.9H40.9601ZM46.0801 38.9V41.46H48.6401V38.9H46.0801ZM51.2001 38.9V41.46H53.7601V38.9H51.2001ZM12.8001 42.74V47.86H15.3601V42.74H12.8001ZM17.9201 42.74V47.86H20.4801V42.74H17.9201ZM23.0401 42.74V47.86H25.6001V42.74H23.0401ZM28.1601 42.74V47.86H30.7201V42.74H28.1601ZM40.9601 44.02V46.58H43.5201V44.02H40.9601ZM46.0801 44.02V46.58H48.6401V44.02H46.0801ZM51.2001 44.02V46.58H53.7601V44.02H51.2001ZM40.9601 49.14V51.7H43.5201V49.14H40.9601ZM46.0801 49.14V51.7H48.6401V49.14H46.0801ZM51.2001 49.14V51.7H53.7601V49.14H51.2001ZM12.8001 50.42V56.82H15.3601V50.42H12.8001ZM28.1601 50.42V56.82H30.7201V50.42H28.1601ZM40.9601 54.26V56.82H43.5201V54.26H40.9601ZM46.0801 54.26V56.82H48.6401V54.26H46.0801ZM51.2001 54.26V56.82H53.7601V54.26H51.2001Z"
              fill={`${role === "company" ? "#fff" : "var(--main-color)"}`}
            />
          </svg>
          <p className={`absolute -bottom-14 text-center  text-xl`}>company</p>
        </li>
        <li
          className={`sm:w-1/3  duration-500 relative ${
            role === "instructor"
              ? "bg-[var(--main-color)] scale-110 font-bold text-[var(--main-color)]"
              : "bg-white"
          } p-6 sm:p-12 rounded-full cursor-pointer`}
          onClick={() => setRole("instructor")}
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="64"
            height="65"
            viewBox="0 0 64 65"
            fill="none"
          >
            <g clipPath="url(#clip0_153_6136)">
              <path
                d="M32 27.5743C39.4645 27.5743 45.5372 21.5016 45.5372 0.0371C45.5374 6.57271 39.4645 0.5 32 0.5C24.5356 0.5 18.4629 6.57271 18.4629 14.0371C18.4629 21.5018 24.5356 27.5743 32 27.5743ZM32 3.73232C37.6823 3.73232 42.3048 8.35508 42.3048 14.0371C42.3048 19.7192 37.6821 24.342 32 24.342C26.318 24.342 21.6952 19.7192 21.6952 14.0371C21.6952 8.35508 26.318 3.73232 32 3.73232Z"
                fill={`${role === "instructor" ? "#fff" : "var(--main-color)"}`}
              />
              <path
                d="M54.6096 58.5152L50.1703 40.0999C49.6436 37.9143 47.7055 36.3878 45.4567 36.3878C42.637 36.3878 21.0634 36.3878 18.5431 36.3878C16.2947 36.3878 14.3564 37.9143 13.8294 40.0999L9.39015 58.5152C8.65536 61.5638 10.9641 64.5 14.1038 64.5H49.8962C53.0321 64.5 55.3457 61.5683 54.6096 58.5152ZM14.1038 61.2677C13.0588 61.2677 12.2875 60.2903 12.5327 59.2728L16.9719 40.8573C17.1475 40.1287 17.7936 39.6201 18.5433 39.6201H25.9012L23.8631 54.038C23.8027 54.4647 23.9151 54.8976 24.1754 55.2406L28.7459 61.2677H14.1038ZM27.1581 53.8242L29.166 39.6203H34.8342L36.8421 53.8242L32 60.2092L27.1581 53.8242ZM49.8962 61.2677H35.2541L39.8243 55.2408C40.0846 54.8976 40.1971 54.4647 40.1367 54.0382L38.0985 39.6203H45.4565C46.206 39.6203 46.8522 40.1291 47.0278 40.8578L51.4671 59.273C51.7122 60.2895 50.9425 61.2677 49.8962 61.2677Z"
                fill={`${role === "instructor" ? "#fff" : "var(--main-color)"}`}
              />
            </g>
            <defs>
              <clipPath id="clip0_153_6136">
                <rect
                  width="64"
                  height="64"
                  fill="white"
                  transform="translate(0 0.5)"
                />
              </clipPath>
            </defs>
          </svg>
          <p className={`absolute -bottom-14 text-center  text-xl`}>
            instructor
          </p>
        </li>
      </ul>
      <p className="capitalize ms-1 mt-1 mb-3 text-red-600">
        {selectUserError}
      </p>

      <div className="w-3/4 sm:w-1/2 md:w-1/3 flex flex-col gap-5">
        <button
          className="w-full bg-btn h-14  flex justify-center items-center "
          onClick={() => {
            alertFunction();
          }}
        >
          Next Step
        </button>
        <a
          href="/register/sign"
          className="w-full border-btn h-14  flex justify-center items-center "
        >
          Back
        </a>
      </div>

      <div
        className={`flex items-center bg-red-500 text-white text-sm font-bold px-4 py-3 absolute right-0 ${
          alert ? "opacity-100" : "opacity-0"
        } duration-500 `}
        role="alert"
      >
        <svg className="fill-current w-4 h-4 mr-2" viewBox="0 0 20 20">
          <path d="M12.432 0c1.34 0 2.01.912 2.01 1.957 0 1.305-1.164 2.512-2.679 2.512-1.269 0-2.009-.75-1.974-1.99C9.789 1.436 10.67 0 12.432 0zM8.309 20c-1.058 0-1.833-.652-1.093-3.524l1.214-5.092c.211-.814.246-1.141 0-1.141-.317 0-1.689.562-2.502 1.117l-.528-.88c2.572-2.186 5.531-3.467 6.801-3.467 1.057 0 1.233 1.273.705 3.23l-1.391 5.352c-.246.945-.141 1.271.106 1.271.317 0 1.357-.392 2.379-1.207l.6.814C12.098 19.02 9.365 20 8.309 20z" />
        </svg>
        <p className="capitalize">please select your role.</p>
      </div>
    </main>
  );
};

export default page;
